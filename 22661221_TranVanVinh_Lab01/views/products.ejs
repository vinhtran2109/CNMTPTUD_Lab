<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Product Management - ShopDB</title>
  <link rel="stylesheet" href="/style.css">
</head>
<body>
  <!-- Header -->
  <header class="navbar">
    <div class="container">
      <h1 class="logo">üõí ShopDB</h1>
      <nav>
        <span class="user-info">Welcome, <%= user && user.fullname ? user.fullname : (user && user.username ? user.username : 'User') %>!</span>
        <a href="/logout" class="btn btn-secondary">Logout</a>
      </nav>
    </div>
  </header>

  <!-- Main Content -->
  <div class="container main-content">
    <!-- Product Form -->
    <div class="card">
      <h2><%= editProduct ? '‚úèÔ∏è Edit Product' : '‚ûï Add New Product' %></h2>
      <form action="<%= editProduct ? '/update/' + editProduct.id : '/add' %>" method="POST" class="product-form">
        <div class="form-row">
          <div class="form-group">
            <label for="name">Product Name</label>
            <input type="text" id="name" name="name" value="<%= editProduct ? editProduct.name : '' %>" required>
          </div>
          
          <div class="form-group">
            <label for="price">Price ($)</label>
            <input type="number" id="price" name="price" step="0.01" min="0" value="<%= editProduct ? editProduct.price : '' %>" required>
          </div>
          
          <div class="form-group">
            <label for="quantity">Quantity</label>
            <input type="number" id="quantity" name="quantity" min="0" value="<%= editProduct ? editProduct.quantity : '' %>" required>
          </div>
        </div>
        
        <div class="form-actions">
          <button type="submit" class="btn <%= editProduct ? 'btn-warning' : 'btn-primary' %>">
            <%= editProduct ? 'Update Product' : 'Add Product' %>
          </button>
          <% if (editProduct) { %>
            <a href="/" class="btn btn-secondary">Cancel</a>
          <% } %>
        </div>
      </form>
    </div>

    <!-- Products Table -->
    <div class="card">
      <h2>üì¶ Product List (<%= products.length %> items)</h2>
      
      <% if (products.length === 0) { %>
        <p class="no-data">No products found. Add your first product above!</p>
      <% } else { %>
        <div class="table-responsive">
          <table class="product-table">
            <thead>
              <tr>
                <th>ID</th>
                <th>Product Name</th>
                <th>Price</th>
                <th>Quantity</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody>
              <% products.forEach(p => { %>
                <tr class="<%= editProduct && editProduct.id === p.id ? 'editing' : '' %>">
                  <td><%= p.id %></td>
                  <td><strong><%= p.name %></strong></td>
                  <td>$<%= parseFloat(p.price).toFixed(2) %></td>
                  <td>
                    <span class="badge <%= p.quantity > 20 ? 'badge-success' : p.quantity > 0 ? 'badge-warning' : 'badge-danger' %>">
                      <%= p.quantity %>
                    </span>
                  </td>
                  <td class="actions">
                    <a href="/edit/<%= p.id %>" class="btn btn-sm btn-warning">‚úèÔ∏è Edit</a>
                    <a href="/delete/<%= p.id %>" class="btn btn-sm btn-danger" 
                       onclick="return confirm('Are you sure you want to delete <%= p.name %>?')">
                      üóëÔ∏è Delete
                    </a>
                  </td>
                </tr>
              <% }) %>
            </tbody>
          </table>
        </div>
      <% } %>
    </div>
  </div>

  <footer>
    <p>&copy; 2026 ShopDB - Product Management System | Express.js + EJS + MySQL</p>
  </footer>
</body>
</html>
